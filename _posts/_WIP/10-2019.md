# 如何開始棕地應用的首個單元測試

## 前言
 
    建築領域所說的棕地（brownfield），指的是一塊年久失修的荒蕪建地，如果將這塊地好好整理一番，則仍可能恢復其利用價值。對軟體開發人員來說，棕地應用程式（brownfield application）指的是一個既有的軟體專案，此專案可能因為用了一些不好的開發方式、結構、或設計而產生許多問題，但若經過仔細的整理和重構（refactoring），還是有機會起死回生。

 這段文字引自[「軟體構築美學」][1]一書對棕地應用的描述，非常貼近大多數開發人員會面臨的開發情境。
 
 對於沒有寫過單元測試的開發人員，面對棕地程式要如何開始第一個單元測試。

## 邊緣類別
 對於缺少測試的棕地程式來說，要開始第一個單元測試可以先選擇從邊緣類別開始，邊緣類別就是其邏輯處理過程沒有相依類別提供服務。

 選擇邊緣類別作為開始單元測試的原因在於，若是類別的方法具有相依類別，則在測試撰寫過還需要應用解耦技巧，對於第一個測試來說可能太過複雜，因此第一個單元測試會是確認回傳值或物件屬性判斷，較為直覺。

 選用邊綠類別因為其特性，一般說來會其程式段落會比較單純易於理解。
## 確定有用
 找到符合的邊緣類別後，要確認該邊緣類別是仍有用的類別，例如是否確認某個操作最終會呼叫到該類別，以避免投入資源產出測試對使用者及系統沒有價值。

 在確認系統邊緣類別可在其公開方法上加上中斷點，然後進行系統的各項操作，逐一記錄各個邊錄類別公開方法被呼叫的情形，包含傳入值及回傳值，接著就可以進入下一步。

## 決定案例
 若是在進行邊緣類別的測試撰寫，則在前面確認步驟，應該已經有收集到呼叫的傳入及輸出資訊，就可以依據這些資料建立對案例。
 
 若是尚未透過操作取得輸入及輸出資訊的類別，則可以從所有傳入參數為空物件的處理開始建立該類別的第一個案例，然後接再來再逐步發展不同定義域。

## 開始測試
測試案例的覆蓋率影響測試的有效程度。


[1]:https://www.books.com.tw/products/0010485217 "軟體構築美學：當專案團隊遇上失控程式，最真實的解決方案"


# 測試什麼的情
* 沒有相依類別
* 具備相依類別
    * 相依類別互動關係
    * 相依類別的影響

## 確認執行後的回傳值
## 確認執行後的屬性值
## 確認互動關係
* 有無互動
* 互動次數
* 互動順序
## 相依物件的情形
* 回傳不同值的影響
* 非同步呼叫時，不同回傳順序的影響

# 解耦的技術-透過 yield 語法解耦輪詢過程的判斷條件

* 案件清單，數量 A
* 程序清單，數量 B
* 狀態清單，數量 C

取得所有顯示資訊是 A*B*C 假設 1000 案件，各有10 個程序，三種狀態
則結果是  1000 * 10 * 3 = 30000 次運算，
但是書面每次顯示 50 筆，其實只需要 50*10*3 = 1500 二十分之一的運算量

```csharp

public class Main
{
    public void Main()
    {
        var objCaseSet = this.GetAllCase();
        foreach(Case objCase in objCaseSet)
        {
            objCase.SetFlow();
        } 
    }
    
    private IEnumable GetAllCase()
    {
        
    }
}

public class Case
{
    public Flow Flow{get;set;}
}

public class Flow:IEnmable
{
    public 
}
```